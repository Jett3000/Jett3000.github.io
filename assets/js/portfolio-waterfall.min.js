var attractors=[],agents=[];const palette=["#f94144","#f3722c","#f8961e","#f9c74f","#90be6d","#43aa8b","#577590"],sketchNode=document.getElementById("waterfall-sketch-container");function setup(){createCanvas(sketchNode.clientWidth,sketchNode.clientHeight).parent(sketchNode),noFill();let t=random()<.5?t=>random(width/e)+t*width/e:t=>random(width/e)+(3-t)*width/e,s=random()<.5?t=>random(height/e)+t*height/e:t=>random(height/e)+(3-t)*height/e,e=int(random(3,6));for(let r=0;r<e;r++){let e=constrain(t(r),.1*width,.9*width),a=constrain(s(r),.1*height,.9*height);attractors.push(createVector(e,a))}let r=(attractors[0].x+attractors[attractors.length-1].x)/2,a=(attractors[0].y+attractors[attractors.length-1].y)/2,o=width/2-r,h=height/2-a;attractors.forEach((t=>{t.x+=o,t.y+=h}));let i=floor(random(24,33));for(let t=0;t<i;t++)agents.push(new Agent(attractors[0].x,attractors[0].y));agents.sort(((t,s)=>t.noiseOffset-s.noiseOffset)),background("#0e0e0e")}function draw(){background(14,10),strokeWeight(4),agents.forEach((t=>{t.done||(t.step(),t.show(),allDone=!1)})),drawAttractors()}function drawAttractors(){strokeWeight(2),stroke(255),fill(0),attractors.forEach(((t,s)=>{s<attractors.length-1&&line(t.x,t.y,attractors[s+1].x,attractors[s+1].y),ellipse(t.x,t.y,16)}))}class Agent{constructor(t,s){this.pos=createVector(t,s),this.vel=createVector(0,0),this.searchingFor=1,this.noiseOffset=agents.length*random(10),this.speed=1+random(),this.col=random(palette)}attrDist(t){return abs(this.pos.x-attractors[t].x)+abs(this.pos.y-attractors[t].y)}step(){this.vel=p5.Vector.sub(attractors[this.searchingFor],this.pos).setMag(this.speed),this.vel.rotate((noise((frameCount+this.noiseOffset)/120)-.5)*(.65*TWO_PI)),this.pos.add(this.vel),this.attrDist(this.searchingFor)<6&&(this.searchingFor<attractors.length-1?this.searchingFor+=1:(this.pos.x=attractors[0].x,this.pos.y=attractors[0].y,this.searchingFor=1))}show(){stroke(this.col),point(this.pos.x,this.pos.y)}}